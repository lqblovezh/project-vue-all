(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{228:function(t,e,a){"use strict";a.r(e);var i=a(320),n=a(262);for(var s in n)"default"!==s&&function(t){a.d(e,t,function(){return n[t]})}(s);var o=a(3),r=Object(o.a)(n.default,i.a,i.b,!1,null,"4d19e317",null);e.default=r.exports},262:function(t,e,a){"use strict";a.r(e);var i=a(263),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,function(){return i[t]})}(s);e.default=n.a},263:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t},s=l(a(97)),o=l(a(264)),r=a(300),c=(i=r)&&i.__esModule?i:{default:i};function l(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}e.default={components:{Detail:c.default},data:function(){return{detailDialog:!1,detail:null,searchData:{name:"",nick_name:"",phone:"",email:"",time_start:"",time_end:""},list:null,page:{offset:10,total:6,num:1},active:null}},mounted:function(){this.init()},methods:{init:function(){this.getList()},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=n({pageNum:e,pageOffset:this.page.offset},this.searchData);return o.getList(a).then(function(e){t.list=e.data,t.page=e.page})},currentChange:function(t){this.getList(t)},openDetailDialog:function(){this.detailDialog=!0},getDetail:function(){var t=this;o.detail({id:this.active}).then(function(e){t.detail=e.data,e.data?t.detail.manager_id=t.active:t.detail.manager_id="",t.detailDialog=!0})},add:function(){this.detail=null,this.detailDialog=!0},forbid:function(t,e){var a=this;this.$confirm(e+"该用户，该用户的系统将处于"+e+"状态?").then(function(e){s.disabled(t).then(function(e){a.$message.success("操作成功!"),t.status=!t.status})})},buttonClickHandler:function(t,e){var a=this,i=t.target.title;switch(i){case"禁用":case"启用":this.forbid(e,i);break;case"删除":this.$confirm("危险操作,删除后无法恢复!,是否真的要删除？").then(function(t){a.$confirm("再次确认!").then(function(t){o.del({id:e.id}).then(function(t){return a.getList()},function(t){a.$message.error("关联有出版社,无法删除...")})})});break;case"详情":this.active=e.id,this.getDetail()}},detailSave:function(t){this.detailDialog=!1,this.getList()},checkAll:function(t){this.$checkAll(t)},formatType:function(t){return t.join(", ")}}}},264:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)("/system/app_manager/managers",t)},e.del=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/system/app_manager/managers/delete",t)},e.detail=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)(o(t),t)},e.save=function(t){var e=t.id,a=function(t,e){var a={};for(var i in t)e.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i]);return a}(t,["id"]);if(e)return(0,n.request_put)(o({id:e}),a);return(0,n.request_post)("/system/app_manager/managers",a).then(function(t){a.apps.forEach(function(e){r({manager_id:t.data.id,app_id:e.id})})})},e.getApps=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)("/system/app/apps",t)},e.authorize=r,e.revoke=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/system/app_manager/managers/app_revoke",t)};var i,n=a(64),s=a(65);var o=((i=s)&&i.__esModule?i:{default:i}).default.compile("/system/app_manager/managers/:id");function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/system/app_manager/managers/app_authorize",t)}},265:function(t,e,a){"use strict";a.r(e);var i=a(266),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,function(){return i[t]})}(s);e.default=n.a},266:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});c(a(95));var i,n=c(a(264)),s=a(301),o=(i=s)&&i.__esModule?i:{default:i},r=a(303);function c(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}e.default={components:{List:o.default},props:["isVis","detail"],created:function(){this.localVis=this.isVis,this.detail&&(this.data=this.detail),this.initAuthority()},data:function(){return{data:{type:[],apps:[]},authority:{publish:"",read:"",data:"",teach:""},localVis:!1,isShow:!1,show:!1}},methods:{addLicensePic:function(){},addApp:function(){this.isShow=!0},delApp:function(t,e){var a=this;this.detail?(this.$confirm("是否删除?").then(function(i){n.revoke({manager_id:a.detail.manager_id,app_id:e.id}).then(function(t){a.$emit("refurbish")},function(e){a.data.apps.splice(t,1)})}),this.data=this.detail):this.data.apps.splice(t,1)},initAuthority:function(){},authorize:function(t){this.authority[t]=!this.authority[t]},save:function(){var t=this;n.save(this.data).then(function(e){t.data.apps.forEach(function(t){var a={manager_id:e.data.id,app_id:t.id};t.isChecked&&n.authorize(a)}),(0,r.setTimeout)(function(e){t.$emit("save",!0)},100)},function(e){t.$message.error(e.toString())})},interim:function(t){var e=this,a=[];this.data.apps.forEach(function(t){a.push(t.id)}),t.forEach(function(t){a.includes(t.id)||e.data.apps.push(t)})}},watch:{isVis:function(){this.localVis=this.isVis},detail:function(){this.data=this.detail}}}},267:function(t,e,a){"use strict";a.r(e);var i=a(268),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,function(){return i[t]})}(s);e.default=n.a},268:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,n=a(63),s=(i=n)&&i.__esModule?i:{default:i},o=a(264);e.default={props:["isShow","detail"],data:function(){return{list:null,page:{offset:10,total:6,num:1},checkAllState:!1,name:"",show:!0}},created:function(){this.getList(),this.show=this.isShow},methods:{getList:function(t){var e=this;(0,o.getApps)(t).then(function(t){var a=e.detail.apps.map(function(t){return t.id});e.detail.apps.length==t.data.length&&(e.checkAllState=!0),e.list=t.data.map(function(t){return a.includes(t.id)?t.isChecked=!0:(t.isChecked=!1,e.checkAllState=!1),t})})},currentChange:function(t){this.getList(t)},add:function(){var t,e=(t=s.default.mark(function t(){var e;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=[],this.list.forEach(function(t){t.isChecked&&e.push(t)}),this.$emit("isOpen"),this.$emit("updata",e);case 4:case"end":return t.stop()}},t,this)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(n,s){try{var o=e[n](s),r=o.value}catch(t){return void a(t)}if(!o.done)return Promise.resolve(r).then(function(t){i("next",t)},function(t){i("throw",t)});t(r)}("next")})});return function(){return e.apply(this,arguments)}}(),checkAll:function(t){var e=this;this.checkAllState=!this.checkAllState,this.list.forEach(function(t){t.isChecked=e.checkAllState})},changeChecked:function(t,e){e.isChecked=t.target.checked,t.target.checked||(this.checkAllState=!1)},search:function(){this.getList({name:this.name})}},watch:{isShow:function(){this.show=this.isShow,this.getList()}}}},269:function(t,e,a){},270:function(t,e,a){},300:function(t,e,a){"use strict";a.r(e);var i=a(324),n=a(265);for(var s in n)"default"!==s&&function(t){a.d(e,t,function(){return n[t]})}(s);a(305);var o=a(3),r=Object(o.a)(n.default,i.a,i.b,!1,null,"dfed4966",null);e.default=r.exports},301:function(t,e,a){"use strict";a.r(e);var i=a(328),n=a(267);for(var s in n)"default"!==s&&function(t){a.d(e,t,function(){return n[t]})}(s);a(302);var o=a(3),r=Object(o.a)(n.default,i.a,i.b,!1,null,"515256a8",null);e.default=r.exports},302:function(t,e,a){"use strict";var i=a(269);a.n(i).a},303:function(t,e,a){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function s(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new s(n.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new s(n.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},a(304),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,a(4))},304:function(t,e,a){(function(t,e){!function(t,a){"use strict";if(!t.setImmediate){var i,n,s,o,r,c=1,l={},u=!1,d=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick(function(){h(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,a=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=a,e}}()?t.MessageChannel?((s=new MessageChannel).port1.onmessage=function(t){h(t.data)},i=function(t){s.port2.postMessage(t)}):d&&"onreadystatechange"in d.createElement("script")?(n=d.documentElement,i=function(t){var e=d.createElement("script");e.onreadystatechange=function(){h(t),e.onreadystatechange=null,n.removeChild(e),e=null},n.appendChild(e)}):i=function(t){setTimeout(h,0,t)}:(o="setImmediate$"+Math.random()+"$",r=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&h(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",r,!1):t.attachEvent("onmessage",r),i=function(e){t.postMessage(o+e,"*")}),f.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),a=0;a<e.length;a++)e[a]=arguments[a+1];var n={callback:t,args:e};return l[c]=n,i(c),c++},f.clearImmediate=p}function p(t){delete l[t]}function h(t){if(u)setTimeout(h,0,t);else{var e=l[t];if(e){u=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(a,i)}}(e)}finally{p(t),u=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,a(4),a(67))},305:function(t,e,a){"use strict";var i=a(270);a.n(i).a},320:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"comps"},[t.detailDialog?a("Detail",{attrs:{detail:t.detail,isVis:t.detailDialog},on:{save:t.detailSave,"update:isVis":function(e){t.detailDialog=e},"update:is-vis":function(e){t.detailDialog=e},refurbish:function(e){return t.getDetail()}}}):t._e()],1),a("div",{staticClass:"content-wrap"},[a("div",{staticClass:"content"},[a("div",{staticClass:"search",on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getList()}}},[a("form",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchData.name,expression:"searchData.name"}],staticClass:"form-control",attrs:{placeholder:"账户"},domProps:{value:t.searchData.name},on:{input:function(e){e.target.composing||t.$set(t.searchData,"name",e.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchData.phone,expression:"searchData.phone"}],staticClass:"form-control",attrs:{placeholder:"电话"},domProps:{value:t.searchData.phone},on:{input:function(e){e.target.composing||t.$set(t.searchData,"phone",e.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchData.nick_name,expression:"searchData.nick_name"}],staticClass:"form-control",attrs:{placeholder:"联系人"},domProps:{value:t.searchData.nick_name},on:{input:function(e){e.target.composing||t.$set(t.searchData,"nick_name",e.target.value)}}}),a("div",{staticClass:"seatch-btns"},[a("el-button",{attrs:{plain:"",icon:"el-icon-search",size:"medium",type:"primary"},on:{click:function(e){return t.getList()}}},[t._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-plus",size:"medium",type:"primary"},on:{click:t.add}},[t._v("新建  ")])],1)])]),t.list?a("div",{staticClass:"table-warp"},[a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",{attrs:{width:"60"}},[a("input",{attrs:{type:"checkbox"},on:{click:function(e){return t.checkAll(e)}}})]),a("th",[t._v("账户")]),a("th",[t._v("电话")]),a("th",[t._v("创建时间")]),a("th",[t._v("联系人")]),a("th",[t._v("拥有出版社")]),a("th",[t._v("操作")])])]),a("tbody",t._l(t.list,function(e){return a("tr",{key:e.id},[a("th",[a("input",{ref:"inps",refInFor:!0,attrs:{type:"checkbox"}})]),a("th",[a("div",{staticClass:"ell",attrs:{title:e.name}},[t._v(t._s(e.name)+"   ")])]),a("th",[a("div",{staticClass:"ell",attrs:{title:e.phone}},[t._v(t._s(e.phone)+"   ")])]),a("th",[a("div",{staticClass:"ell"},[t._v(t._s(e.create_time.substr(0,10))+"   ")])]),a("th",[a("div",{staticClass:"ell",attrs:{title:e.nick_name}},[t._v(t._s(e.nick_name)+" ")])]),a("th",t._l(e.apps,function(e){return a("div",{staticClass:"ell",attrs:{title:e.name+(e.publisher?"("+e.publisher.name+")":null)}},[t._v(t._s(e.name)+" "+t._s(e.publisher?"("+e.publisher.name+")":null))])}),0),a("th",[a("div",{staticClass:"table-btns",on:{click:function(a){return t.buttonClickHandler(a,e)}}},[a("span",{staticClass:"icon icon-delete",attrs:{title:"删除"}}),a("span",{staticClass:"icon icon-detail",attrs:{title:"详情"}})])])])}),0)]),t.page.total?a("div",{staticClass:"pages"},[a("Pages",{attrs:{currentPage:t.page.num,total:t.page.total,pageSize:t.page.offset,pageSizes:[t.page.offset,20,50,100]},on:{currentChange:t.currentChange}})],1):t._e()]):t._e()])])])},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},324:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("List",{attrs:{isShow:t.isShow,detail:t.data},on:{"update:isShow":function(e){t.isShow=e},"update:is-show":function(e){t.isShow=e},refurbish:function(e){return t.$emit("refurbish")},updata:t.interim,isOpen:function(e){t.isShow=!1}}}),a("el-dialog",{attrs:{visible:t.localVis,width:"1200px"},on:{"update:visible":function(e){t.localVis=e},closed:function(e){return t.$emit("update:isVis",t.localVis)}}},[t.data?a("div",{staticClass:"content"},[a("div",{staticClass:"base fix"},[a("div",{staticClass:"tname"},[t._v("基本信息 ")]),a("div",{staticClass:"form-group"},[a("label",[t._v("账户")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.name,expression:"data.name"}],staticClass:"form-control",attrs:{placeholder:"必填"},domProps:{value:t.data.name},on:{input:function(e){e.target.composing||t.$set(t.data,"name",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",[t._v("联系人")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.nick_name,expression:"data.nick_name"}],staticClass:"form-control",domProps:{value:t.data.nick_name},on:{input:function(e){e.target.composing||t.$set(t.data,"nick_name",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",[t._v("联系方式")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.phone,expression:"data.phone"}],staticClass:"form-control",domProps:{value:t.data.phone},on:{input:function(e){e.target.composing||t.$set(t.data,"phone",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",[t._v("联系邮箱")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.email,expression:"data.email"}],staticClass:"form-control",domProps:{value:t.data.email},on:{input:function(e){e.target.composing||t.$set(t.data,"email",e.target.value)}}})])]),a("div",{staticClass:"base sys"},[a("div",{staticClass:"tname"},[t._v("拥有出版社")]),a("span",{staticClass:"sys-list-name"},[t._v("出版社列表  ")]),a("div",{staticClass:"xlist"},[t._l(t.data.apps,function(e,i){return t.data.apps?a("div",{staticClass:"item"},[a("div",{staticClass:"form-group"},[a("label",[t._v("出版社名称")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"i.name"}],staticClass:"form-control",attrs:{readonly:"readonly"},domProps:{value:e.name},on:{input:function(a){a.target.composing||t.$set(e,"name",a.target.value)}}})]),a("span",{staticClass:"icon icon-delete",on:{click:function(a){return t.delApp(i,e)}}})]):t._e()}),a("div",{staticClass:"fix"},[a("div",{staticClass:"add-btn"},[a("Btn",{on:{click:t.addApp}},[t._v("新增  ")])],1)])],2)]),a("div",{staticClass:"bottom"},[a("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保存        ")])],1)]):t._e()])],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},328:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{visible:t.show,width:"1200px"},on:{"update:visible":function(e){t.show=e},close:function(e){return t.$emit("isOpen")}}},[a("div",{staticClass:"box"},[a("el-input",{staticClass:"keys",attrs:{size:"small",placeholder:"出版社名称"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.search}},[t._v("搜索")])],1),t.list?a("div",{staticClass:"table-warp"},[a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",{attrs:{width:"60"}},[a("input",{attrs:{type:"checkbox"},domProps:{checked:t.checkAllState},on:{click:function(e){return t.checkAll(e)}}})]),a("th",[t._v("出版社名")]),a("th",[t._v("简介")]),a("th",[t._v("创建时间")])])]),a("tbody",t._l(t.list,function(e,i){return a("tr",{key:e.id},[a("th",[a("input",{ref:"inps",refInFor:!0,attrs:{type:"checkbox","data-index":i},domProps:{value:e.id,checked:e.isChecked},on:{click:function(a){return t.changeChecked(a,e)}}})]),a("th",[a("div",{staticClass:"ell"},[t._v(t._s(e.name)),e.publisher?a("span",[t._v("("+t._s(e.publisher.name)+")")]):t._e()])]),a("th",[a("div",{staticClass:"ell"},[t._v(t._s(e.exp)+"   ")])]),a("th",[a("div",{staticClass:"ell"},[t._v(t._s(e.create_time)+" ")])])])}),0)]),t.page.total?a("div",{staticClass:"pages"},[a("Pages",{attrs:{currentPage:t.page.num,total:t.page.total,pageSize:t.page.offset,pageSizes:[t.page.offset,20,50,100]},on:{currentChange:t.currentChange}})],1):t._e()]):t._e(),a("div",{staticClass:"bottom"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.add}},[t._v("保存   ")])],1)])},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})}}]);