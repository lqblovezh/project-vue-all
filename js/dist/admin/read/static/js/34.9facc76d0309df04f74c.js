(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{1081:function(e,t,a){"use strict";var l=a(600);a.n(l).a},1087:function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"indexs"},[a("div",{staticClass:"mainRight"},[a("div",{staticClass:"maindata"},[a("div",{staticClass:"serachWrap"},[a("div",{staticClass:"NavList"},[a("el-tabs",{on:{"tab-click":e.handleNavClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"管理员列表",name:"manager"}}),a("el-tab-pane",{attrs:{label:"管理员日志",name:"journal"}}),a("el-tab-pane",{attrs:{label:"角色管理",name:"role"}})],1)],1),a("form",{attrs:{id:"mainForm"}},[a("el-row",{attrs:{gutter:5}},[a("el-col",{attrs:{span:3}},[a("input",{staticClass:"form-control",attrs:{name:"name",placeholder:"输入用户名搜索"}})]),a("el-col",{staticClass:"right",attrs:{span:21}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",plain:""},on:{click:e.seareHandeler}},[e._v("搜索")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",plain:""},on:{click:function(t){return e.showDetaile()}}},[e._v("新增")])],1)],1)],1)]),a("div",{staticClass:"tableWrap"},[a("table",{staticClass:"table"},[e._m(0),e.pageList.length?a("tbody",e._l(e.pageList,function(t){return a("tr",[a("td",{domProps:{textContent:e._s(t.name)}}),a("td",{domProps:{textContent:e._s(t.exp)}}),a("td",[a("span",{staticClass:"icon icon-detail",attrs:{type:"primary",title:"详情",plain:"",size:"mini"},on:{click:function(a){return e.showDetaile(t.id)}}}),a("span",{staticClass:"icon icon-delete",attrs:{type:"primary",title:"删除",plain:"",size:"mini"},on:{click:function(a){return e.deleteHandeler([t.id])}}})])])}),0):e._e()])])]),a("el-dialog",{attrs:{visible:e.detailVisible,"before-close":e.handleClose,"lock-scroll":!1,width:"70%"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("el-tabs",{attrs:{value:"detail"}},[a("el-tab-pane",{attrs:{label:"详情",name:"detail"}})],1)],1),a("el-form",{ref:"detailDialog",attrs:{model:e.detailDate,rules:e.detailRules}},[a("el-form-item",{attrs:{label:"角色名:","label-width":"120px",prop:"name"}},[a("el-input",{model:{value:e.detailDate.name,callback:function(t){e.$set(e.detailDate,"name",t)},expression:"detailDate.name"}})],1),a("el-form-item",{attrs:{label:"角色描述:","label-width":"120px",prop:"exp"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.detailDate.exp,callback:function(t){e.$set(e.detailDate,"exp",t)},expression:"detailDate.exp"}})],1)],1),a("table",{staticClass:"table border",attrs:{width:"100%",id:"detailTable"}},[a("thead",[a("tr",[a("th",[a("span",[e._v("页面显示")]),e.detailDate.accesses?a("input",{ref:"checkAll",attrs:{type:"checkbox"},domProps:{checked:e.isAllChecked},on:{click:e.selectAll}}):e._e(),a("span",[e._v("全选")])]),a("th",[e._v("权限功能")])])]),a("tbody",e._l(e.detailDate.accesses,function(t,l){return a("tr",[a("td",{attrs:{align:"center"}},[a("input",{ref:"ids",refInFor:!0,attrs:{type:"checkbox",name:"pages",id:"item_"+t.id},domProps:{checked:e.isChecked(t)},on:{click:function(t){return e.handlePageClick(l,t)}}}),a("label",{attrs:{for:"item_"+t.id},domProps:{textContent:e._s(t.name)}})]),a("td",{attrs:{align:"left"}},[a("ul",{staticClass:"options"},[a("li",[a("input",{attrs:{type:"checkbox",id:"items_"+t.id+"add","data-type":"allow_create"},domProps:{checked:t.allow_create},on:{click:function(t){return e.handleOptionsClick(l,t)}}}),a("label",{attrs:{for:"items_"+t.id+"add"}},[e._v("新增")])]),a("li",[a("input",{attrs:{type:"checkbox",id:"items_"+t.id+"del","data-type":"allow_delete_all"},domProps:{checked:t.allow_delete_all},on:{click:function(t){return e.handleOptionsClick(l,t)}}}),a("label",{attrs:{for:"items_"+t.id+"del"}},[e._v("删除")])]),a("li",[a("input",{attrs:{type:"checkbox",id:"items_"+t.id+"mod","data-type":"allow_edit_all"},domProps:{checked:t.allow_edit_all},on:{click:function(t){return e.handleOptionsClick(l,t)}}}),a("label",{attrs:{for:"items_"+t.id+"mod"}},[e._v("修改")])]),a("li",[a("input",{attrs:{type:"checkbox",id:"items_"+t.id+"viw","data-type":"allow_view_all"},domProps:{checked:t.allow_view_all},on:{click:function(t){return e.handleOptionsClick(l,t)}}}),a("label",{attrs:{for:"items_"+t.id+"viw"}},[e._v("查询")])])])])])}),0)]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"info"},on:{click:e.handleClose}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确定")])],1)],1)],1)])},i=[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",[this._v("角色名")]),t("th",{attrs:{width:"400"}},[this._v("角色描述")]),t("th",[this._v("操作")])])])}];a.d(t,"a",function(){return l}),a.d(t,"b",function(){return i})},281:function(e,t,a){"use strict";a.r(t);var l=a(1087),i=a(598);for(var n in i)"default"!==n&&function(e){a.d(t,e,function(){return i[e]})}(n);a(1081);var r=a(0),o=Object(r.a)(i.default,l.a,l.b,!1,null,"d1b2be38",null);t.default=o.exports},389:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e};t.listRole=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)("/common/manager/roles",e)},t.listManager=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)("/common/manager/managers",e)},t.addManager=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/common/manager/managers",e)},t.modifyManager=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,a=s(e,["id"]);return(0,n.request_put)(c({id:t}),a)},t.detailManager=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,a=s(e,["id"]);return(0,n.request_get)(c({id:t}),a)},t.detailRole=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,a=s(e,["id"]);return t?(0,n.request_get)(d({id:t}),a).then(function(e){var t={};if(e.status){t=e.data.accesses;var a={allow_create:0,allow_view_all:0,allow_view_group:0,allow_view_own:0,allow_edit_all:0,allow_edit_group:0,allow_edit_own:0,allow_delete_all:0,allow_delete_group:0,allow_delete_own:0};return u().then(function(e){if(e.status){var i=e.data,n={};for(var r in i)n[i[r].id]=l({},i[r],a),t[i[r].id]&&(n[i[r].id]=l({},i[r],t[i[r].id]));return e.data=n,e}})}}):f()},t.allJurisdiction=u,t._allJurisdiction=f,t.role=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,a=s(e,["id"]);if(t)return(0,n.request_put)(d({id:t}),a);return(0,n.request_post)("/common/manager/roles",a)},t.addRole=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/common/manager/roles",e)},t.deleteManager=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/common/manager/managers/delete",e)},t.deleteRole=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/common/manager/roles/delete",e)},t.logManager=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)("/common/manager/logs",e)};var i,n=a(76),r=a(106),o=(i=r)&&i.__esModule?i:{default:i};function s(e,t){var a={};for(var l in e)t.indexOf(l)>=0||Object.prototype.hasOwnProperty.call(e,l)&&(a[l]=e[l]);return a}var c=o.default.compile("/common/manager/managers/:id"),d=o.default.compile("/common/manager/roles/:id");function u(){return(0,n.request_get)("/common/manager/accesses")}function f(){return(0,n.request_get)("/common/manager/accesses").then(function(e){if(e.status){var t={allow_create:0,allow_view_all:0,allow_view_group:0,allow_view_own:0,allow_edit_all:0,allow_edit_group:0,allow_edit_own:0,allow_delete_all:0,allow_delete_group:0,allow_delete_own:0},a=e.data,i={};for(var n in a)i[a[n].id]=l({},a[n],t);return e.data=i,e}})}},598:function(e,t,a){"use strict";a.r(t);var l=a(599),i=a.n(l);for(var n in l)"default"!==n&&function(e){a.d(t,e,function(){return l[e]})}(n);t.default=i.a},599:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},i=(o(a(289)),o(a(392))),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(389)),r=a(290);function o(e){return e&&e.__esModule?e:{default:e}}t.default={mixins:[r.publicMixin],data:function(){return{pageList:[],query:null,path:"jurisdiction",activeName:"role",detailVisible:!1,detailDate:{id:"",name:"",exp:"",accesses:{}},detailRules:{name:[{required:!0,message:"请输入角色名",trigger:"blur"}],exp:[{required:!0,message:"请输入角色描述",trigger:"blur"}]}}},methods:{getList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,i=arguments[2],r=l({pageNum:e,pageOffset:a},i);n.listRole(r).then(function(e){t.page=e.page,t.pageList=e.data})},showDetaile:function(e){var t=this;this.detailDate.id=this.detailDate.name=this.detailDate.exp="",n.detailRole({id:e}).then(function(a){if(e){var l=t.pageList.find(function(t){return t.id===e});t.detailDate.id=e,t.detailDate.name=l.name,t.detailDate.exp=l.exp}t.detailDate.accesses=a.data,t.detailVisible=!0})},deleteHandeler:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.length||Array.from(document.querySelectorAll("[name='checkbox']:checked")).forEach(function(e){t.push(e.value)}),!t.length)return this.$message.error("请确认你要删除的内容！");this.$confirm("确认删除？").then(function(a){n.deleteRole({id:t}).then(function(t){e.getList()})}).catch(function(e){})},save:function(){var e=this;this.$refs.detailDialog.validate(function(t){if(!t)return!1;var a=e.$loading({text:"保存中...",background:"rgba(0, 0, 0, 0.8)"});n.role(e.detailDate).then(function(t){e.$message.success("保存成功"),a.close(),e.getList(),e.detailVisible=!1}).catch(function(t){var l=t.payload;for(var i in a.close(),l.messages){e.$message.error(l.messages[i]);break}})})},handlePageClick:function(e,t){var a=t.target.checked?1:0,l=this.detailDate.accesses[e];a||(this.$refs.checkAll.checked=!1),l.allow_create=a,l.allow_delete_all=a,l.allow_edit_all=a,l.allow_view_all=a},handleOptionsClick:function(e,t){t.target.checked||(this.$refs.checkAll.checked=!1);var a=t.target.getAttribute("data-type"),l=t.path[3].querySelectorAll("input").length,i=t.path[3].querySelectorAll("input:checked").length;this.detailDate.accesses[e][a]=l===i?1:0},isChecked:function(e){return e.allow_create&&e.allow_delete_all&&e.allow_edit_all&&e.allow_view_all},selectAll:function(e){var t=e.target.checked?1:0,a=this.detailDate.accesses;for(var l in a)a[l].allow_create=t,a[l].allow_delete_all=t,a[l].allow_edit_all=t,a[l].allow_view_all=t}},computed:{isAllChecked:function(){var e=this.detailDate.accesses,t=!0,a=!1,l=void 0;try{for(var i,n=Object.keys(e)[Symbol.iterator]();!(t=(i=n.next()).done);t=!0){var r=e[i.value];if(!(r.allow_create&&r.allow_delete_all&&r.allow_edit_all&&r.allow_view_all))return!1}}catch(e){a=!0,l=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw l}}return!0}},components:{Menu:i.default}}},600:function(e,t,a){}}]);