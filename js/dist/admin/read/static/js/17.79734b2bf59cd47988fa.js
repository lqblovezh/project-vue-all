(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{1055:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.request_get)("/read/discover/list",t)},e.del=function(t){var e=t.id;return(0,i.request_delete)(s({id:e[0]}))},e.save=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.request_post)("/read/discover/add",t)};var a,i=n(76),r=n(106);var s=((a=r)&&a.__esModule?a:{default:a}).default.compile("/read/discover/:id")},1056:function(t,e,n){"use strict";var a=n(551);n.n(a).a},1104:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"clearfix"},[n("div",{staticClass:"mainRight"},[n("div",{staticClass:"contentWrap"},[n("div",{staticClass:"contentLeft"},[n("div",{staticClass:"maindata"},[n("div",{staticClass:"tableWrap",staticStyle:{position:"relative",top:"20px"}},[n("div",{staticClass:"tableTop"},[n("div",{staticClass:"title"},[n("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:function(e){t.detailAddDialog=!0}}},[t._v("新增")])],1)]),n("table",{staticClass:"table"},[t._m(0),t.list?n("tbody",{ref:"mainBody"},t._l(t.list,function(e){return n("tr",[n("th",[t._v(t._s(e.books_info?e.books_info.name:""))]),n("th",[t._v(t._s(e.type_name))]),n("th",[n("Icon",{attrs:{type:"icon-delete",title:"删除"},on:{click:function(n){return t.del(e.discover_id)}}})],1)])}),0):t._e()])])])])])]),t.detailAddDialog?n("Resource",{attrs:{detailAddDialog:t.detailAddDialog,curSoucesList:t.list},on:{"update:detailAddDialog":function(e){t.detailAddDialog=e},"update:detail-add-dialog":function(e){t.detailAddDialog=e},select:t.addSelection}}):t._e()],1)},i=[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("名称")]),e("th",[this._v("类型")]),e("th",{attrs:{width:"100"}},[this._v("操作")])])])}];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return i})},265:function(t,e,n){"use strict";n.r(e);var a=n(1104),i=n(549);for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);n(1056);var s=n(0),o=Object(s.a)(i.default,a.a,a.b,!1,null,"6879e45f",null);e.default=o.exports},312:function(t,e,n){"use strict";n.r(e);var a=n(313),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);e.default=i.a},313:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=c(n(15)),i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},r=(n(413),function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(382))),s=c(n(289)),o=n(290);function c(t){return t&&t.__esModule?t:{default:t}}e.default={mixins:[o.publicMixin],props:{detailAddDialog:{type:Boolean,default:!1},singleElection:Boolean,curSoucesList:{type:Array,default:[]}},data:function(){return{dataList:[],page:null,currentType:"book",contentType:[{name:"图书",value:"book"},{name:"主题",value:"theme"},{name:"听读",value:"audio"},{name:"视读",value:"video"},{name:"课件",value:"course"},{name:"文章",value:"article"}]}},created:function(){log(this.curSoucesList)},methods:{getList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.page&&this.page.num||1,e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.page&&this.page.offset||10,a=arguments[2],s=i({pageNum:t,pageOffset:n,shelf:!0},a,{type:this.currentType||this.contentType[0].value});r.getMainList(s).then(function(t){e.dataList=t.data,e.page=t.page})},colse:function(){this.$emit("update:detailAddDialog",!1)},seareHandeler:function(){var t=(0,s.default)(document.querySelector("#detailSearchForm"),{hash:!0});this.getList(1,this.page.offset,t)},addSelection:function(){var t,e=(t=a.default.mark(function t(){var e,n,i,r,s,o,c,l,u,d,f=this;return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.querySelector(".addBookForm"),n=e.querySelectorAll('input[name="ids"]:checked'),i=[],r=[],n.length){t.next=5;break}return t.abrupt("return",this.$message.warning("请选择添加内容"));case 5:s=!0,o=!1,c=void 0,t.prev=8,l=function(){var t=d.value;if(f.curSoucesList.findIndex(function(e){return e.b_id==t.value||e.id==t.value})>-1)return"continue";i.push(f.dataList.find(function(e){return e.id==t.value}).id),r.push(f.dataList.find(function(e){return e.id==t.value}))},u=n[Symbol.iterator]();case 11:if(s=(d=u.next()).done){t.next=18;break}if("continue"!==l()){t.next=15;break}return t.abrupt("continue",15);case 15:s=!0,t.next=11;break;case 18:t.next=24;break;case 20:t.prev=20,t.t0=t.catch(8),o=!0,c=t.t0;case 24:t.prev=24,t.prev=25,!s&&u.return&&u.return();case 27:if(t.prev=27,!o){t.next=30;break}throw c;case 30:return t.finish(27);case 31:return t.finish(24);case 32:this.$emit("select",i,r);case 33:case"end":return t.stop()}},t,this,[[8,20,24,32],[25,,27,31]])}),function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function a(i,r){try{var s=e[i](r),o=s.value}catch(t){return void n(t)}if(!s.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});t(o)}("next")})});return function(){return e.apply(this,arguments)}}(),checkAll:function(t,e){document.querySelector("."+e).querySelectorAll('input[name="ids"]').forEach(function(e,n){e.checked=t.target.checked})},uncheckedAll:function(t){this.singleElection&&(this.$refs.ids.forEach(function(t){return t.checked=!1}),t.target.checked=!0)},isChecked:function(t){return this.curSoucesList.findIndex(function(e){return e.b_id===t||e.id===t||e.src===t})>-1},handleSizeChange:function(t){var e=(0,s.default)(document.querySelector("#detailSearchForm"),{hash:!0});this.getList(1,t,e)},handleCurrentChange:function(t){var e=(0,s.default)(document.querySelector("#detailSearchForm"),{hash:!0});this.getList(t,this.page.offset,e)}},watch:{currentType:function(t){this.getList(1)}}}},314:function(t,e,n){},366:function(t,e,n){"use strict";n.r(e);var a=n(391),i=n(312);for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);n(386);var s=n(0),o=Object(s.a)(i.default,a.a,a.b,!1,null,"d0669fbc",null);e.default=o.exports},386:function(t,e,n){"use strict";var a=n(314);n.n(a).a},391:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-dialog",{attrs:{center:!1,visible:t.detailAddDialog,width:"1000px",top:"50px","show-close":!1,"append-to-body":""}},[n("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[n("span",{staticClass:"el-icon-close",on:{click:t.colse}}),n("el-tabs",{attrs:{value:"detail"}},[n("el-tab-pane",{attrs:{label:"添加",name:"detail"}})],1)],1),n("el-form",{staticClass:"addBookForm"},[n("span",{staticClass:"group-inline",staticStyle:{margin:"0 20px"}},[n("el-radio-group",{model:{value:t.currentType,callback:function(e){t.currentType=e},expression:"currentType"}},t._l(t.contentType,function(e){return n("el-radio-button",{key:e.id,attrs:{label:e.value}},[t._v(t._s(e.name))])}),1)],1),n("div",{staticClass:"serachWrap"},[n("form",{attrs:{id:"detailSearchForm"}},[n("span",{staticClass:"group-inline"},[n("input",{staticClass:"form-control",attrs:{placeholder:"输入名称",name:"name"}})]),n("span",{staticClass:"group-inline"},[n("TimePick",{attrs:{inputsName:["start_time","end_time"]}})],1),n("span",{staticClass:"group-inline right"},[n("el-button",{attrs:{type:"primary",icon:"el-icon-search",plain:""},on:{click:t.seareHandeler}},[t._v("搜索")]),n("el-button",{attrs:{type:"primary",plain:""},on:{click:t.addSelection}},[t._v("添加选中")])],1)])]),n("table",{staticClass:"table",attrs:{width:"100%"}},[n("thead",[n("tr",[n("th",{attrs:{width:"80"}},[t.singleElection?t._e():n("input",{attrs:{type:"checkbox"},on:{click:function(e){return t.checkAll(e,"addBookForm")}}}),n("span",{domProps:{textContent:t._s(t.singleElection?"选择":"全选")}})]),n("th",[t._v("名称")]),n("th",[t._v("标签")]),n("th",[t._v("类型")]),n("th",[t._v("创建时间")])])]),t.dataList.length?n("tbody",t._l(t.dataList,function(e,a){return n("tr",[n("td",[n("input",{ref:"ids",refInFor:!0,attrs:{type:"checkbox","data-type":e.status,name:"ids"},domProps:{value:e.id,checked:t.isChecked(e.id)},on:{click:t.uncheckedAll}})]),n("td",[t._v(t._s(e.books_info.name))]),n("td",[t._v(t._s(e.books_info.tag))]),n("td",[t._v(t._s(e.type_name))]),n("td",[t._v(t._s(e.create_time))])])}),0):t._e()]),t.page?n("div",{staticClass:"pageWrap"},[n("el-pagination",{attrs:{small:!1,background:"","current-page":t.page.num,"page-sizes":[10,50,100],"page-size":t.page.offset,layout:"total, sizes,prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()]),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"info"},on:{click:t.colse}},[t._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.addSelection}},[t._v("确定")])],1)],1)],1)},i=[];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return i})},549:function(t,e,n){"use strict";n.r(e);var a=n(550),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);e.default=i.a},550:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,i=c(n(1055)),r=(c(n(382)),n(290)),s=n(366),o=(a=s)&&a.__esModule?a:{default:a};n(44);function c(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}e.default={components:{Resource:o.default},mixins:[r.publicMixin,r.circleMixin],data:function(){return{detailAddDialog:!1,constitute:[],services:i}},methods:{addSelection:function(t){var e=this;log(t),i.save({id:t}).then(function(t){e.getList(),e.detailAddDialog=!1}).catch(function(t){var n=t.payload;for(var a in n.messages){e.$message.error(n.messages[a]);break}})}}}},551:function(t,e,n){}}]);